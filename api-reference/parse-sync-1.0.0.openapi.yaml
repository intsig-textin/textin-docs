openapi: 3.0.3
info:
  title: XParse Parse Sync API
  description: |
    ç‹¬ç«‹çš„æ–‡æ¡£è§£æåŒæ­¥APIæ¥å£ï¼Œæ”¯æŒå°†éç»“æ„åŒ–æ–‡æ¡£è½¬æ¢ä¸ºç»“æ„åŒ–å…ƒç´ ã€‚
    
    è¯¥APIä¸Pipelineä¸­çš„ParseèŠ‚ç‚¹åŠŸèƒ½ä¸€è‡´ï¼Œä½†ä½œä¸ºç‹¬ç«‹æ¥å£æä¾›ï¼Œé€‚ç”¨äºåªéœ€è¦æ–‡æ¡£è§£æåŠŸèƒ½çš„åœºæ™¯ã€‚
  version: 1.0.0
  contact:
    name: TextIn API Team

servers:
  - url: https://api.textin.com
    description: ç”Ÿäº§ç¯å¢ƒ

security:
  - AppIdAuth: []
    SecretCodeAuth: []

paths:
  /api/xparse/parse/sync:
    post:
      summary: åŒæ­¥æ–‡æ¡£è§£æ
      description: |
        åŒæ­¥æ‰§è¡Œæ–‡æ¡£è§£æï¼Œå°†éç»“æ„åŒ–æ–‡æ¡£è½¬æ¢ä¸ºç»“æ„åŒ–å…ƒç´ ã€‚
        
        è¯¥æ¥å£ä¼šç«‹å³è¿”å›è§£æç»“æœï¼Œé€‚ç”¨äºå°æ–‡ä»¶æˆ–éœ€è¦åŒæ­¥è·å–ç»“æœçš„åœºæ™¯ã€‚
        
        è¾“å‡ºæ ¼å¼ä¸Pipeline ParseèŠ‚ç‚¹å®Œå…¨ä¸€è‡´ã€‚
      operationId: parseSync
      tags:
        - XParse Parse
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: éœ€è¦å¤„ç†çš„æ–‡æ¡£æ–‡ä»¶ï¼ˆæ”¯æŒ PDFã€WORDã€EXCELã€PPTã€å›¾ç‰‡ç­‰[å¤šç§æ ¼å¼](/pipeline/sources/overview#æ”¯æŒçš„æ–‡ä»¶æ ¼å¼)ï¼‰
                config:
                  type: string
                  description: |
                    Parseé…ç½®çš„ JSON å­—ç¬¦ä¸²ï¼ˆå¯é€‰ï¼‰ï¼Œä¸Pipeline ParseèŠ‚ç‚¹é…ç½®ä¸€è‡´ã€‚
                    
                    å¦‚æœæœªæä¾›ï¼Œå°†ä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆprovider: "textin"ï¼‰ã€‚
                    
                    é…ç½®æ ¼å¼å‚è€ƒ[æ–‡æ¡£è§£æ - Parse](/pipeline/parse)ã€‚
                  example: '{"provider": "textin", "parse_mode": "auto"}'
            encoding:
              config:
                contentType: application/json
      responses:
        '200':
          description: è§£æç»“æœ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/codemessage'
                  - $ref: '#/components/schemas/ParseSyncResponse'
              examples:
                success:
                  summary: æˆåŠŸç¤ºä¾‹
                  value:
                    code: 200
                    msg: "success"
                    data:
                      file_id: "xxx"
                      status: "completed"
                      result:
                        elements:
                          - element_id: "13a9939f23e485ca20a16c741658bcf64efd82309a6f0a8cf35679a65b2fd0dc"
                            type: "NarrativeText"
                            metadata:
                              filename: "example.pdf"
                              filetype: "application/pdf"
                              last_modified: "1758624866230"
                              page_number: 1
                              page_width: 1191
                              page_height: 1684
                              coordinates: [0.1822, 0.2316, 0.6717, 0.2316, 0.6717, 0.2732, 0.1822, 0.2732]
                            text: "è¿™æ˜¯è§£æå‡ºçš„æ–‡æœ¬å†…å®¹"
                error:
                  summary: é”™è¯¯ç¤ºä¾‹
                  value:
                    code: 40004
                    msg: "Parameter error"
                    data:
                      file_id: "xxx"
                      status: "failed"
                      message: "File not uploaded"

components:
  securitySchemes:
    AppIdAuth:
      type: apiKey
      in: header
      name: x-ti-app-id
      description: 'è¯·[ç™»å½•Textin](https://www.textin.com/console/dashboard/setting)åå‰å¾€ "å·¥ä½œå°-è´¦å·è®¾ç½®-å¼€å‘è€…ä¿¡æ¯" æŸ¥çœ‹ x-ti-app-id'
    SecretCodeAuth:
      type: apiKey
      in: header
      name: x-ti-secret-code
      description: 'è¯·[ç™»å½•Textin](https://www.textin.com/console/dashboard/setting)åå‰å¾€ "å·¥ä½œå°-è´¦å·è®¾ç½®-å¼€å‘è€…ä¿¡æ¯" æŸ¥çœ‹ x-ti-secret-code'

  schemas:
    codemessage:
      type: object
      required:
        - code
        - msg
      properties:
        code:
          type: integer
          default: 200
          description: |
            çŠ¶æ€ç 
            - 200: Success
            - 40101: x-ti-app-id æˆ– x-ti-secret-code ä¸ºç©º
            - 40102: x-ti-app-id æˆ– x-ti-secret-code æ— æ•ˆï¼ŒéªŒè¯å¤±è´¥
            - 40004: å‚æ•°é”™è¯¯ï¼Œè¯·æŸ¥çœ‹æŠ€æœ¯æ–‡æ¡£ï¼Œæ£€æŸ¥ä¼ å‚
            - 500: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
            
            æ›´å¤šè¯¦ç»†é”™è¯¯ä¿¡æ¯å‚è€ƒ[é”™è¯¯ç è¯´æ˜](/pipeline/error)ã€‚
          enum:
            - 200
            - 40101
            - 40102
            - 40004
            - 500
        msg:
          type: string
          description: é”™è¯¯ä¿¡æ¯
          example: "success"
    
    ParseSyncResponse:
      type: object
      required:
        - data
      properties:
        data:
          $ref: '#/components/schemas/ParseSyncData'
    
    ParseSyncData:
      type: object
      required:
        - file_id
        - status
      properties:
        file_id:
          type: string
          description: æ–‡ä»¶ID
          example: "xxx"
        status:
          type: string
          description: å¤„ç†çŠ¶æ€
          enum: [completed, failed]
          example: "completed"
        result:
          type: object
          description: è§£æç»“æœï¼ˆä»…åœ¨statusä¸ºcompletedæ—¶è¿”å›ï¼‰
          properties:
            elements:
              type: array
              description: è§£æåçš„å…ƒç´ åˆ—è¡¨ï¼Œä¸Pipeline ParseèŠ‚ç‚¹è¾“å‡ºä¸€è‡´
              items:
                $ref: '#/components/schemas/Element'
        message:
          type: string
          description: é”™è¯¯ä¿¡æ¯ï¼ˆä»…åœ¨statusä¸ºfailedæ—¶è¿”å›ï¼‰
          example: "error msg"
    
    Element:
      type: object
      required:
        - element_id
        - type
        - metadata
        - text
      properties:
        element_id:
          type: string
          description: å…ƒç´ å”¯ä¸€æ ‡è¯†ç¬¦
          example: "13a9939f23e485ca20a16c741658bcf64efd82309a6f0a8cf35679a65b2fd0dc"
        type:
          type: string
          description: å…ƒç´ ç±»å‹ï¼ˆå¦‚ Title, NarrativeText, Table ç­‰ï¼‰
          example: "NarrativeText"
        metadata:
          $ref: '#/components/schemas/Metadata'
        text:
          type: string
          description: å…ƒç´ çš„æ–‡æœ¬å†…å®¹
          example: "è¿™æ˜¯æ–‡æ¡£ä¸­çš„ä¸€æ®µæ–‡æœ¬"
    
    Metadata:
      type: object
      required:
        - filename
      properties:
        filename:
          type: string
          description: æ–‡ä»¶å
          example: "example.pdf"
        filetype:
          type: string
          description: æ–‡ä»¶ç±»å‹
          example: "application/pdf"
        last_modified:
          type: string
          description: æ–‡ä»¶æœ€åä¿®æ”¹æ—¶é—´ï¼ˆUnix æ¯«ç§’æ—¶é—´æˆ³ï¼‰
          example: "1758624866230"
        page_number:
          type: integer
          description: å…ƒç´ æ‰€åœ¨çš„é¡µç 
          example: 1
        page_width:
          type: integer
          description: å…ƒç´ æ‰€åœ¨çš„é¡µé¢çš„å®½åº¦ï¼ˆå•ä½ï¼šåƒç´ ï¼‰
          example: 1191
        page_height:
          type: integer
          description: å…ƒç´ æ‰€åœ¨çš„é¡µé¢çš„é«˜åº¦ï¼ˆå•ä½ï¼šåƒç´ ï¼‰
          example: 1684
        parent_id:
          type: string
          description: çˆ¶å…ƒç´  ID
          example: "24a9939f23e485ca20a16c741658bcf64efd82309a6f0a8cf35679a65b2fd0dc"
        category_depth:
          type: integer
          description: å…ƒç´ åœ¨åŒç±»å…ƒç´ ä¸­çš„ç›®å½•æ·±åº¦
          example: 1
        coordinates:
          type: array
          description: |
            å…ƒç´ åœ¨é¡µé¢ä¸Šçš„åæ ‡ã€‚ä»¥é•¿åº¦ä¸º 8 çš„æµ®ç‚¹æ•°ç»„è¡¨ç¤ºå››è¾¹å½¢ï¼Œ8 ä¸ªæ•°ä¸¤ä¸¤ä¸€ç»„ä¸ºä¸€ä¸ªç‚¹çš„æ¨ªçºµåæ ‡ï¼Œåˆ†åˆ«æ˜¯å·¦ä¸Šã€å³ä¸Šã€å³ä¸‹ã€å·¦ä¸‹ã€‚
            åæ ‡ä¸ºå½’ä¸€åŒ–åæ ‡ï¼ŒèŒƒå›´åœ¨ [0, 1] ä¹‹é—´ï¼Œä¿ç•™4ä½å°æ•°ã€‚åæ ‡å€¼ç›¸å¯¹äºé¡µé¢å°ºå¯¸ï¼ˆpage_width Ã— page_heightï¼‰è¿›è¡Œå½’ä¸€åŒ–ã€‚
          items:
            type: number
            format: float
          minItems: 8
          maxItems: 8
          example: [0.1822, 0.2316, 0.6717, 0.2316, 0.6717, 0.2732, 0.1822, 0.2732]
        text_as_html:
          type: string
          description: è¡¨æ ¼æˆ–å¯Œæ–‡æœ¬çš„ HTML è¡¨ç¤º
          example: "<table>...</table>"
        image_base64:
          type: string
          description: |
            å›¾ç‰‡çš„ base64 ç¼–ç ã€‚
            å½“å¼€å¯get_sub_imageæ—¶è¿”å›ï¼Œå›¾ç‰‡å…ƒç´ çš„base64è¡¨ç¤ºã€‚
        image_mine_type:
          type: string
          description: å›¾ç‰‡çš„ MIME ç±»å‹
          example: "image/png"
        page_image_url:
          type: string
          description: |
            é¡µé¢å›¾ç‰‡çš„ä¸‹è½½é“¾æ¥ã€‚å½“å¼€å¯get_page_imageæ—¶è¿”å›ã€‚
            å¦‚æœå¼€å¯é¢„å¤„ç†å‚æ•°ï¼ˆåˆ‡è¾¹å¢å¼º-crop_dewarpã€å»æ°´å°-remove_watermarkï¼‰ï¼Œ
            è¿”å›çš„æ˜¯é¢„å¤„ç†åçš„é¡µé¢å›¾ç‰‡ã€‚
          example: "https://your-file-server.com/download?filename=abc123.png"
        original_image_url:
          type: string
          description: |
            æœªç»é¢„å¤„ç†çš„åŸå§‹é¡µé¢å›¾ç‰‡é“¾æ¥ã€‚
            ä»…åœ¨å¼€å¯é¢„å¤„ç†å‚æ•°ï¼ˆåˆ‡è¾¹å¢å¼ºæˆ–å»æ°´å°ï¼‰æ—¶è¿”å›ã€‚
          example: "https://your-file-server.com/download?filename=def456.png"
        figure_caption_id:
          type: string
          description: |
            å½“å…ƒç´ typeä¸ºImageæ—¶ï¼Œè¡¨ç¤ºå¯¹åº”çš„å›¾ç‰‡æ ‡é¢˜ï¼ˆtype=FigureCaptionï¼‰å…ƒç´ idã€‚
          example: "caption_element_id_here"
        data_source:
          type: object
          description: æ•°æ®æºè¯¦ç»†ä¿¡æ¯
          properties:
            record_locator:
              type: object
              properties:
                protocol:
                  type: string
                  example: "file"
                remote_file_path:
                  type: string
                  example: "/projects/demo/example.pdf"
            url:
              type: string
              example: "file:///projects/demo/example.pdf"
            version:
              type: string
              example: "1758624866230967485"
            date_created:
              type: string
              example: "1764555574237"
            date_modified:
              type: string
              example: "1758624866230"
            date_processed:
              type: string
              example: "1764742970688"

tags:
  - name: XParse Parse
    description: |
      ç‹¬ç«‹çš„æ–‡æ¡£è§£æAPIæ¥å£
      
      ## åŠŸèƒ½ç‰¹æ€§
      - ğŸ“„ å¤šæ ¼å¼æ”¯æŒï¼šæ”¯æŒ PDFã€å›¾ç‰‡ç­‰å¤šç§æ–‡æ¡£æ ¼å¼
      - ğŸ” å¤šå¼•æ“æ”¯æŒï¼šæ”¯æŒ TextInã€MinerUã€PaddleOCR ç­‰å¤šç§è§£æå¼•æ“
      - ğŸ“Š ç»“æ„åŒ–è¾“å‡ºï¼šå°†æ–‡æ¡£è½¬æ¢ä¸ºæ ‡å‡†åŒ–çš„å…ƒç´ ç»“æ„
      - ğŸ¯ è¯­ä¹‰ä¿ç•™ï¼šä¿ç•™æ–‡æ¡£çš„è¯­ä¹‰ç»“æ„ï¼Œå¦‚æ ‡é¢˜ã€æ®µè½ã€è¡¨æ ¼ç­‰
      
      ## è®¡è´¹è¯´æ˜
      - æŒ‰ç…§å¤„ç†çš„é¡µæ•°è®¡è´¹
      - è®¡è´¹ä¿¡æ¯é€šè¿‡ x-ti-app-id å’Œ x-ti-secret-code è¿›è¡Œå…³è”
